@page
@model Vehicle_Dealer_Management.Pages.Customer.DashboardModel
@{
    ViewData["Title"] = "Dashboard - Kh√°ch h√†ng";
    ViewData["UserRole"] = "CUSTOMER";
    ViewData["UserName"] = Model.CustomerName;
}

<div class="content-header">
    <h1 class="content-title">Ch√†o m·ª´ng, @Model.CustomerName!</h1>
    <p class="content-subtitle">Kh√°m ph√° v√† theo d√µi ƒë∆°n h√†ng c·ªßa b·∫°n</p>
</div>

<!-- Outstanding Debt Alert -->
@if (Model.TotalOutstandingDebt > 0)
{
    <div class="alert alert-warning mb-4" style="background: var(--warning-bg); border: 1px solid var(--warning); color: var(--warning); padding: 1rem; border-radius: var(--radius);">
        <div style="display: flex; align-items: center; gap: 0.75rem;">
            <i class="bi bi-exclamation-triangle" style="font-size: 1.5rem;"></i>
            <div style="flex: 1;">
                <div style="font-weight: 600; margin-bottom: 0.25rem;">C·∫ßn thanh to√°n d∆∞ n·ª£</div>
                <div style="font-size: 1.125rem;">
                    B·∫°n c√≤n n·ª£ <strong style="color: var(--error);">@Model.TotalOutstandingDebt.ToString("N0") VND</strong>. 
                    Vui l√≤ng thanh to√°n ƒë·ªß 100% ƒë∆°n h√†ng tr∆∞·ªõc khi ƒë·∫∑t mua xe m·ªõi.
                </div>
            </div>
            <a href="/Customer/MyOrders" class="btn btn-primary btn-sm">
                <i class="bi bi-arrow-right"></i> Thanh to√°n ngay
            </a>
        </div>
    </div>
}

<!-- Stats Row -->
<div class="grid grid-cols-4 mb-4">
    <div class="stat-card">
        <div class="flex justify-between items-center">
            <div class="stat-label">B√°o gi√°</div>
            <i class="bi bi-file-text" style="font-size: 1.5rem; color: var(--accent-cyan);"></i>
        </div>
        <div class="stat-value">@Model.QuotesCount</div>
        <div class="stat-change neutral">
            <span>B√°o gi√° ƒëang ch·ªù</span>
        </div>
    </div>

    <div class="stat-card">
        <div class="flex justify-between items-center">
            <div class="stat-label">ƒê∆°n h√†ng</div>
            <i class="bi bi-receipt" style="font-size: 1.5rem; color: var(--success);"></i>
        </div>
        <div class="stat-value">@Model.OrdersCount</div>
        <div class="stat-change neutral">
            <span>ƒê∆°n h√†ng c·ªßa b·∫°n</span>
        </div>
    </div>

    <div class="stat-card">
        <div class="flex justify-between items-center">
            <div class="stat-label">L·ªãch l√°i th·ª≠</div>
            <i class="bi bi-calendar-check" style="font-size: 1.5rem; color: var(--warning);"></i>
        </div>
        <div class="stat-value">@Model.TestDrivesCount</div>
        <div class="stat-change neutral">
            <span>L·ªãch ƒë√£ ƒë·∫∑t</span>
        </div>
    </div>

    <div class="stat-card">
        <div class="flex justify-between items-center">
            <div class="stat-label">Xe c√≥ s·∫µn</div>
            <i class="bi bi-car-front" style="font-size: 1.5rem; color: var(--info);"></i>
        </div>
        <div class="stat-value">@Model.AvailableVehicles</div>
        <div class="stat-change neutral">
            <span>M·∫´u xe ƒëi·ªán</span>
        </div>
    </div>
</div>

<!-- Recent Orders -->
<div class="card mb-4">
    <div class="card-header">
        <div class="flex justify-between items-center">
            <h3 class="card-title mb-0">ƒê∆°n h√†ng g·∫ßn ƒë√¢y</h3>
            <a href="/Customer/MyOrders" class="btn btn-secondary btn-sm">Xem t·∫•t c·∫£</a>
        </div>
    </div>
    <div class="card-body">
        @if (Model.RecentOrders.Any())
        {
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>M√£ ƒë∆°n</th>
                            <th>Ng√†y t·∫°o</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>T·ªïng ti·ªÅn</th>
                            <th>ƒê√£ thanh to√°n</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var order in Model.RecentOrders)
                        {
                            <tr>
                                <td><strong>#@order.Id</strong></td>
                                <td>@order.CreatedAt.ToString("dd/MM/yyyy")</td>
                                <td>@await Html.PartialAsync("_StatusBadge", order.Status)</td>
                                <td><strong>@order.TotalAmount.ToString("N0") VND</strong></td>
                                <td><strong style="color: var(--success);">@order.TotalPaid.ToString("N0") VND</strong></td>
                                <td class="text-right">
                                    <a href="/Customer/OrderDetail?id=@order.Id" class="btn btn-secondary btn-sm">
                                        Chi ti·∫øt
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
        else
        {
            <div class="empty-state">
                <div class="empty-state-icon">üì¶</div>
                <div class="empty-state-title">Ch∆∞a c√≥ ƒë∆°n h√†ng</div>
                <div class="empty-state-text">Kh√°m ph√° c√°c m·∫´u xe ƒëi·ªán v√† ƒë·∫∑t h√†ng ngay!</div>
                <a href="/Customer/Vehicles" class="btn btn-primary mt-3">Xem xe ƒëi·ªán</a>
            </div>
        }
    </div>
</div>

<!-- Quick Actions -->
<div class="grid grid-cols-3">
    <a href="/Customer/Vehicles" class="card" style="text-decoration: none; cursor: pointer;">
        <div class="card-body text-center">
            <i class="bi bi-car-front" style="font-size: 3rem; color: var(--accent-cyan); margin-bottom: 1rem;"></i>
            <h4>Kh√°m ph√° xe ƒëi·ªán</h4>
            <p class="text-muted">Xem danh m·ª•c v√† so s√°nh c√°c m·∫´u xe</p>
        </div>
    </a>

    <a href="/Customer/TestDrive" class="card" style="text-decoration: none; cursor: pointer;">
        <div class="card-body text-center">
            <i class="bi bi-calendar-check" style="font-size: 3rem; color: var(--success); margin-bottom: 1rem;"></i>
            <h4>ƒê·∫∑t l·ªãch l√°i th·ª≠</h4>
            <p class="text-muted">Tr·∫£i nghi·ªám xe ƒëi·ªán tr∆∞·ªõc khi mua</p>
        </div>
    </a>

    <a href="/Customer/MyOrders" class="card" style="text-decoration: none; cursor: pointer;">
        <div class="card-body text-center">
            <i class="bi bi-receipt" style="font-size: 3rem; color: var(--warning); margin-bottom: 1rem;"></i>
            <h4>Theo d√µi ƒë∆°n h√†ng</h4>
            <p class="text-muted">Xem tr·∫°ng th√°i v√† l·ªãch giao xe</p>
        </div>
    </a>
</div>

